{"version":3,"file":"component.newsletter-callout-klaviyo-form-vue.js?v=1733162424563","mappings":"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","sources":["webpack:///../../../../../src/scripts/helpers/datalayer.js","webpack:///../../../../../src/components/async/newsletter-callout/klaviyo-form.vue","webpack:///../../../../../src/components/async/newsletter-callout/klaviyo-form.vue?c58b"],"sourcesContent":["/**\n * Helper: dataLayer\n * ------------------------------------------------------------------------------\n * Handle Universal Data Layer (UDL) action events.\n *\n * @namespace dataLayer\n */\n\nimport { cyrb53 } from '~/helpers/manipulate'\n\n/**\n * Checks if global datalayer variable exists.\n */\nexport function checkForDatalayer() {\n  if (!window.dataLayer) {\n    window.dataLayer = []\n  }\n}\n\n/**\n * Send add to cart event.\n * @param {Object} productData - Updated line item.\n * @param {Object} additionalData - Additional data to be included in the datalayer.\n */\nexport function addToCartEvent(productData, additionalData) {\n  if (!productData ) {\n    return\n  }\n\n  const { pageNameL5 } = cnvs.strings.dataLayer\n  const { type } = cnvs.page\n  checkForDatalayer()\n\n  window.dataLayer.push({\n    event: 'e_addToCart',\n    ecommerce: {\n      currencyCode: window.cnvs.store.currency,\n      add: {\n        ...additionalData,\n        detail: {\n          actionField: { list: pageNameL5[type] },\n        },\n        products: [ formatProductData(productData, 1) ],\n      },\n    },\n  })\n}\n\n/**\n * Send remove from cart event.\n * @param {Object} productData - Updated line item.\n * @param {Number} quantity - Total number of updated item.\n */\n export function removeFromCartEvent(productData, quantity) {\n  if (!productData) {\n    return\n  }\n\n  checkForDatalayer()\n\n  window.dataLayer.push({\n    event: 'e_removeFromCart',\n    ecommerce: {\n      currencyCode: window.cnvs.store.currency,\n      remove: {\n        products: [ formatProductData(productData, quantity) ],\n      },\n    },\n  })\n}\n\n/**\n * Format product details into UDL accepted product.\n * @param {Object} lineItem - Updated item from cart.\n * @param {Number} quantity - Total updated item quantity.\n * @returns {Object}\n */\nfunction formatProductData(lineItem, quantity) {\n  const productType = lineItem.type || lineItem.product_type\n\n  return {\n    name: lineItem.name || lineItem.product_title,\n    id: lineItem.sku,\n    price: (lineItem.price.amount || lineItem.price)  / 100,\n    brand: 'HyperX',\n    category: `MS/accessories/${productType.toLowerCase()\n      .replaceAll(' ', '-')}`,\n    variant: lineItem.title || lineItem.variant_title,\n    quantity: quantity,\n  }\n}\n\n/**\n * Send the order status event.\n */\n  export function sendOrderStatus() {\n  if (window.Shopify?.Checkout?.OrderStatus && window.Shopify?.checkout?.order_id) {\n    window.dataLayer.push({\n      event: 'e_orderStatus',\n      orderNumber: Shopify.checkout.order_id,\n    })\n  }\n}\n\n/**\n * Send a coupon event when it is applied during checkout.\n * @param {String} coupon - The coupon being used during checkout.\n */\nexport function sendCouponApplied(coupon = '') {\n  if (!coupon) {\n    return\n  }\n\n  window.dataLayer.push({\n    event: 'e_couponApplied',\n    couponCode: coupon,\n  })\n}\n\n/**\n* Send email event when user subscribes to newsletter.\n* @param {String} email - The user's email.\n*/\nexport function sendEmailSubscribe(email) {\n  if (!email) {\n    return\n  }\n\n  checkForDatalayer()\n\n  window.dataLayer.push({\n    event: 'e_emailSubscribe',\n    userID: cyrb53(email),\n  })\n}\n\n/**\n * Send conversion event when user completes checkout.\n * @param {Object} orderData - Shopify.checkout object.\n */\nexport function sendConversion(orderData) {\n  window.dataLayer.push({\n    products: orderData.line_items.map((item) => ({\n      price: Number(item.price),\n      quantity: item.quantity,\n      brandname: item.vendor || 'HyperX',\n      sku: item.sku,\n      upc: item.properties?._barcode,\n    })),\n    orderid: orderData.order_id,\n    tags: [],\n  })\n}\n","<template>\n  <form\n    :id=\"formId\"\n    class=\"template-register__klaviyo is-hidden\"\n    method=\"post\"\n    aria-hidden=\"true\"\n    action=\"https://manage.kmail-lists.com/ajax/subscriptions/subscribe\"\n    accept-charset=\"UTF-8\"\n  >\n    <input\n      type=\"hidden\"\n      name=\"$fields\"\n      value=\"$source,$email,Accepts Marketing,$consent_method,$consent_form_id\"\n    >\n    <input\n      type=\"hidden\"\n      name=\"$list_fields\"\n      value=\"Accepts Marketing\"\n    >\n    <input\n      type=\"hidden\"\n      name=\"g\"\n      :value=\"klaviyoListID\"\n    >\n    <input\n      :id=\"`${ formId }_klaviyo_email`\"\n      type=\"email\"\n      name=\"$email\"\n      :value=\"customerEmail\"\n    >\n    <input\n      type=\"hidden\"\n      name=\"$consent_form_id\"\n      :value=\"klaviyoFormID\"\n    >\n    <input\n      type=\"hidden\"\n      name=\"$consent_method\"\n      :value=\"consentMethod\"\n    >\n    <input\n      :id=\"`${ formId }_klaviyo_marketing`\"\n      type=\"hidden\"\n      name=\"Accepts Marketing\"\n      :value=\"checkedConsent ? 'True' : 'False'\"\n    >\n    <input\n      type=\"hidden\"\n      name=\"$source\"\n      :value=\"source\"\n    >\n  </form>\n</template>\n\n<script>\n\n/**\n * Vue: Klaviyo form (Klaviyo-form)\n * -----------------------------------------------------------------------------\n * Klaviyo form.\n *\n * @param {Boolean} checkedConsent - Checked consent\n * @param {String} customerEmail - Customer email.\n * @param {String} formId - Klaviyo form ID.\n * @param {String} source - Klaviyo form source.\n *\n */\n\nimport { sendEmailSubscribe } from '~/helpers/datalayer'\n\nexport default {\n  name: 'KlaviyoForm',\n\n  props: {\n    checkedConsent: {\n      type: Boolean,\n      default: false,\n    },\n    customerEmail: {\n      type: String,\n      default: '',\n    },\n    formId: {\n      type: String,\n      default: 'klaviyoDefault',\n    },\n    source: {\n      type: String,\n      default: '',\n    },\n    consentMethod: {\n      type: String,\n      default: '',\n    },\n  },\n\n  emits: ['submit-shopify-form'],\n\n  data() {\n    return {\n      klaviyoFormID: cnvs.settings.klaviyoFormID,\n      klaviyoListID: cnvs.settings.klaviyoListID,\n    }\n  },\n\n  methods: {\n\n    /**\n     * Submit Klaviyo form.\n     */\n    submit() {\n      const { customerEmail, $el, $emit } = this\n      const formAddress = $el.action\n      const formData = new FormData($el)\n\n      fetch(formAddress, {\n        method: 'POST',\n        body: formData,\n      })\n        .then((response) => response.json())\n        .then(() => {\n          sendEmailSubscribe(customerEmail)\n          $emit('submit-shopify-form')\n        })\n        .catch((error) => window.console.error(error))\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\">\n</style>\n","import { render } from \"./klaviyo-form.vue?vue&type=template&id=3676b310\"\nimport script from \"./klaviyo-form.vue?vue&type=script&lang=js\"\nexport * from \"./klaviyo-form.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/buddy/hyperx-canvas-1/node_modules/@we-make-websites/basis/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["checkForDatalayer","window","dataLayer","addToCartEvent","productData","additionalData","pageNameL5","cnvs","strings","type","page","push","event","ecommerce","currencyCode","store","currency","add","detail","actionField","list","products","formatProductData","removeFromCartEvent","quantity","remove","lineItem","productType","product_type","name","product_title","id","sku","price","amount","brand","category","toLowerCase","replaceAll","variant","title","variant_title","sendEmailSubscribe","email","userID","cyrb53","_createElementVNode","value","props","checkedConsent","Boolean","default","customerEmail","String","formId","source","consentMethod","emits","data","klaviyoFormID","settings","klaviyoListID","methods","submit","$el","$emit","this","formAddress","action","formData","FormData","fetch","method","body","then","response","json","catch","error","console","_createElementBlock","$props","class","_hoisted_2","_hoisted_3","$data"],"sourceRoot":""}