{"version":3,"file":"component.checkout-postal-code-validator.js?v=1733162424563","mappings":"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","sources":["webpack:///../../../../../src/components/async/checkout-postal-code-validator/checkout-postal-code-validator.vue","webpack:///../../../../../src/components/async/checkout-postal-code-validator/checkout-postal-code-validator.vue?45ce"],"sourcesContent":["<template>\n  <div\n    v-if=\"isContactInfoStep && postalCodeField\"\n    class=\"postal-code-validator\"\n  >\n    <button\n      v-if=\"isFormSubmitted && ((!isZipValid && postalCodeValue !== '') || result === false)\"\n      type=\"button\"\n      class=\"postal-code-validator__clear\"\n      @click=\"clearForm\"\n    >\n      <IconCloseFill />\n    </button>\n    <p\n      v-if=\"!isChangedByUser && postalCodeShopifyError\"\n      class=\"postal-code-validator__error-message\"\n      v-text=\"postalCodeShopifyError?.innerText\"\n    />\n    <template v-else>\n      <p\n        v-if=\"isFormSubmitted && !isZipValid && postalCodeValue !== ''\"\n        class=\"postal-code-validator__error-message\"\n        v-text=\"translations.postal_code_validator.error_message\"\n      />\n      <p\n        v-if=\"isLoading\"\n        class=\"postal-code-validator__loading-message\"\n        v-text=\"translations.postal_code_validator.loading_message\"\n      />\n      <p\n        v-if=\"isFormSubmitted && result === false\"\n        class=\"postal-code-validator__error-message\"\n        v-text=\"translations.postal_code_validator.invalid_zip_message\"\n      />\n      <div\n        v-if=\"isFormSubmitted && result === true\"\n        class=\"postal-code-validator__success-notice\"\n      >\n        <div\n          class=\"postal-code-validator__success-message\"\n          v-text=\"translations.postal_code_validator.valid_zip_message\"\n        />\n      </div>\n    </template>\n  </div>\n  <span v-else />\n</template>\n<script>\n\n /**\n * Vue: Checkout postal code validator field (checkout-postal-code-validator)\n * -----------------------------------------------------------------------------\n *\n */\nimport IconCloseFill from '~icons/misc/close--fill.svg'\n\nexport default {\n  name: 'CheckoutPostalCodeValidator',\n  components: {\n    IconCloseFill,\n  },\n  data() {\n    const { checkout } = window.cnvs.strings\n    return {\n      postalCodeField: null,\n      postalCodeFieldId: 'checkout_shipping_address_zip',\n      postalCodeValue: '',\n      postalCodeWrapper: null,\n      postalCodeErrorSelector: \"[id=error-for-zip]\",\n      postalCodeShopifyError: null,\n      postalCodeWrapperSelector: \"[data-address-field='zip']\",\n      submitButton: null,\n      submitButtonId: 'continue_button',\n      translations: {\n        ...checkout,\n      },\n      isChangedByUser: false, // True after input changes\n      isFormSubmitted: false, // True after submission, until a change is made\n      isLoading: false, // True after submission if zip is valid, until a change is made\n      result: null, // Postal code validity result\n    }\n  },\n  computed: {\n    isContactInfoStep() {\n      return Shopify.Checkout.step === 'contact_information'\n    },\n\n    isZipValid() {\n      const zipRegex = /^(?:(?:[2-8]\\d|9[0-7]|0?[28]|0?9(?=09))(?:\\d{2}))$/\n      return zipRegex.test(this.postalCodeValue)\n    },\n\n    /**\n     * The postal code app's domain name, used for API calls\n     * @returns {Boolean}\n     */\n    appDomain() {\n      return cnvs.credentials.hyperx_stacklet.domain\n    },\n  },\n  watch: {\n    result(newResult) {\n      if (newResult === false) {\n        this.addPostalCodeWrapperError()\n      } else {\n        this.removePostalCodeWrapperError()\n      }\n    },\n    postalCodeWrapper() {\n      if (this.result === false) {\n        this.addPostalCodeWrapperError()\n      } else {\n        this.removePostalCodeWrapperError()\n      }\n    },\n  },\n  mounted() {\n    if (this.isContactInfoStep) {\n      this.setSubmitButton()\n      this.setPostalCodeWrapper()\n      this.setPostalCodeField()\n      this.setPostalCodeShopifyError()\n      this.handleSubmit()\n    }\n  },\n  methods: {\n    setPostalCodeField() {\n      this.postalCodeField = document.getElementById(this.postalCodeFieldId)\n      this.postalCodeField.setAttribute('maxlength', 4)\n      this.postalCodeField.addEventListener('keyup', this.handleInputKeyup)\n      this.postalCodeField.addEventListener('change', this.handleInputChange)\n      this.setPostalCodeValue()\n    },\n    setPostalCodeShopifyError() {\n      this.postalCodeShopifyError = document.querySelector(this.postalCodeErrorSelector)\n    },\n\n    setPostalCodeWrapper() {\n      this.postalCodeWrapper = document.querySelector(this.postalCodeWrapperSelector)\n    },\n\n    addPostalCodeWrapperError() {\n      this.postalCodeWrapper.classList.add('field--error')\n    },\n\n    removePostalCodeWrapperError() {\n      this.postalCodeWrapper.classList.remove('field--error')\n    },\n\n    setPostalCodeValue() {\n      this.postalCodeValue = this.postalCodeField.value\n    },\n\n    setSubmitButton() {\n      this.submitButton = document.getElementById(this.submitButtonId)\n      this.submitButton.disabled = true\n      this.submitButton.classList.add('btn--disabled')\n    },\n\n    handleInputChange() {\n      this.setPostalCodeValue()\n      this.isFormSubmitted = false\n      this.isChangedByUser = true\n      this.handleSubmit()\n    },\n\n    handleInputKeyup() {\n      this.setPostalCodeValue()\n      this.isFormSubmitted = false\n      this.isLoading = false\n      this.result = null\n      this.submitButton.disabled = true\n      this.submitButton.classList.add('btn--disabled')\n    },\n\n    async handleSubmit() {\n      if (!this.isFormSubmitted) {\n        this.isFormSubmitted = true\n        this.result = null\n        this.submitButton.disabled = true\n      this.submitButton.classList.add('btn--disabled')\n\n        if (this.isZipValid) {\n          this.isLoading = true\n          // Get postal code validity\n          this.result = await fetch(`https://${\n            this.appDomain\n          }/api/postcode-validator/postcode-lookup?postcode=${this.postalCodeValue}`)\n            .then((result) => result.json())\n            .catch(() => false) // In case of total failure\n          this.isLoading = false\n          if (this.result === true) {\n            this.submitButton.disabled = false\n            this.submitButton.classList.remove('btn--disabled')\n          }\n        }\n      }\n    },\n\n    clearForm() {\n      this.isFormSubmitted = false\n      this.isLoading = false\n      this.result = null\n      this.postalCodeField.value = ''\n      this.setPostalCodeValue()\n    },\n  },\n}\n</script>\n","import { render } from \"./checkout-postal-code-validator.vue?vue&type=template&id=6ac330aa\"\nimport script from \"./checkout-postal-code-validator.vue?vue&type=script&lang=js\"\nexport * from \"./checkout-postal-code-validator.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/buddy/hyperx-canvas-1/node_modules/@we-make-websites/basis/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["name","components","IconCloseFill","data","checkout","window","cnvs","strings","postalCodeField","postalCodeFieldId","postalCodeValue","postalCodeWrapper","postalCodeErrorSelector","postalCodeShopifyError","postalCodeWrapperSelector","submitButton","submitButtonId","translations","isChangedByUser","isFormSubmitted","isLoading","result","computed","isContactInfoStep","Shopify","Checkout","step","isZipValid","test","this","appDomain","credentials","hyperx_stacklet","domain","watch","newResult","addPostalCodeWrapperError","removePostalCodeWrapperError","mounted","setSubmitButton","setPostalCodeWrapper","setPostalCodeField","setPostalCodeShopifyError","handleSubmit","methods","document","getElementById","setAttribute","addEventListener","handleInputKeyup","handleInputChange","setPostalCodeValue","querySelector","classList","add","remove","value","disabled","async","fetch","then","json","catch","clearForm","class","$options","$data","_createElementBlock","type","onClick","_createVNode","_component_IconCloseFill","_toDisplayString","innerText","_Fragment","key","postal_code_validator","error_message","loading_message","invalid_zip_message","_createElementVNode","valid_zip_message","_hoisted_8","__exports__"],"sourceRoot":""}